{
  "RJA_Data_Movement": {
    "Type": "Folder",
    "ControlmServer": "psctm",
    "OrderMethod": "Manual",
    "ActiveRetentionPolicy": "CleanEndedOK",
    "SiteStandard": "RJA_LOOSE_STANDARD",
    "SubApplication": "RJA_FTP",
    "CreatedBy": "rjacobs",
    "Application": "RJA_MFT",
    "When": {
      "RuleBasedCalendars": {
        "Included": [
          "EVERYDAY"
        ],
        "EVERYDAY": {
          "Type": "Calendar:RuleBased",
          "When": {
            "DaysRelation": "OR",
            "WeekDays": [
              "NONE"
            ],
            "MonthDays": [
              "ALL"
            ]
          }
        }
      }
    },
    "RJA_To_AWS_S3": {
      "Type": "Job:FileTransfer",
      "ConnectionProfileSrc": "RJA_B2B",
      "ConnectionProfileDest": "RJA_S3",
      "S3BucketName": "reggies3",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "From the temprary work locataion the file is processed picked up and passed to AWS with PGP encryption. The internal AppDev team needs to review this file before it gets send back.",
      "RunAs": "RJA_B2B+RJA_S3",
      "Application": "RJA_MFT",
      "Variables": [
        {
          "FTP-LOSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE1": "LOCAL"
        },
        {
          "FTP-LHOST": "Local"
        },
        {
          "FTP-LUSER": "ctmagent"
        },
        {
          "FTP-ROSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE2": "S3"
        },
        {
          "FTP-RHOST": "S3"
        },
        {
          "FTP-PGP_ENABLE1": "1"
        },
        {
          "FTP-PGP_TEMPLATE_NAME1": "a_mh01_generic_armored"
        },
        {
          "FTP-TIMELIMIT_UNIT1": "1"
        },
        {
          "FTP-OVERRIDE_WATCH_INTERVAL1": "0"
        },
        {
          "FTP-WATCH_INTERVAL1": "30"
        },
        {
          "FTP-CM_VER": "9.0.19"
        }
      ],
      "FileTransfers": [
        {
          "TransferType": "Binary",
          "TransferOption": "SrcToDest",
          "Src": "/opt/ctm/training/data/RJA_upload_file.txt",
          "Dest": "/RJA_upload_file..asc",
          "TIMELIMIT": "0",
          "ABSTIME": "0",
          "SRCOPT": "0",
          "IF_EXIST": "0",
          "DSTOPT": "0",
          "UNIQUE": "0",
          "RECURSIVE": "0",
          "TRIM": "1",
          "NULLFLDS": "0",
          "VERNUM": "0",
          "EXCLUDE_WILDCARD": "0",
          "CASEIFS": "0"
        }
      ],
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "IfBase:Folder:CompletionStatus_13": {
        "Type": "If:CompletionStatus",
        "CompletionStatus": "OK",
        "Mail_0": {
          "Type": "Action:Mail",
          "Subject": "Payroll File succesfully Uploaded to AWS S3",
          "To": "rjacobs@bmc.com",
          "Message": "The payroll data file has been successfullky uploaded to the processing area.",
          "AttachOutput": true
        }
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_Begin_Data_Movement_TO_RJA_To_AWS_S3"
          }
        ]
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_ToS3_TO_RJA_Time_Delay"
          },
          {
            "Event": "RJA_To_AWS_S3_TO_RJA_Simulating_Processing"
          }
        ]
      },
      "eventsToDelete": {
        "Type": "DeleteEvents",
        "Events": [
          {
            "Event": "RJA_Begin_Data_Movement_TO_RJA_To_AWS_S3"
          }
        ]
      }
    },
    "RJA_Data_Return_From_AWS_S3": {
      "Type": "Job:FileTransfer",
      "ConnectionProfileSrc": "RJA_S3",
      "ConnectionProfileDest": "RJA_B2B",
      "S3BucketName": "reggies3",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "Data Processing complete is now complete. Now we will retrieve the processed file from AWS S3 bucket and move the data back into the B2B area for final approval.",
      "RunAs": "RJA_S3+RJA_B2B",
      "Application": "RJA_MFT",
      "Variables": [
        {
          "FTP-LOSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE1": "S3"
        },
        {
          "FTP-LHOST": "S3"
        },
        {
          "FTP-ROSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE2": "LOCAL"
        },
        {
          "FTP-RHOST": "Local"
        },
        {
          "FTP-RUSER": "ctmagent"
        },
        {
          "FTP-TIMELIMIT_UNIT1": "1"
        },
        {
          "FTP-OVERRIDE_WATCH_INTERVAL1": "0"
        },
        {
          "FTP-WATCH_INTERVAL1": "30"
        },
        {
          "FTP-CM_VER": "9.0.19"
        }
      ],
      "FileTransfers": [
        {
          "TransferType": "Binary",
          "TransferOption": "SrcToDest",
          "Src": "/RJA_upload_file..asc",
          "Dest": "/opt/ctm/training/data/%%processedFilename",
          "TIMELIMIT": "0",
          "ABSTIME": "0",
          "SRCOPT": "1",
          "IF_EXIST": "0",
          "DSTOPT": "0",
          "UNIQUE": "0",
          "RECURSIVE": "0",
          "TRIM": "1",
          "NULLFLDS": "0",
          "VERNUM": "0",
          "EXCLUDE_WILDCARD": "0",
          "CASEIFS": "0"
        }
      ],
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_Finalizing_TO_RJA_Data_Return_From_AWS_S3"
          }
        ]
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_Data_Return_From_AWS_S3_TO_RJA_DATA_Back_to_Customer"
          }
        ]
      },
      "eventsToDelete": {
        "Type": "DeleteEvents",
        "Events": [
          {
            "Event": "RJA_Finalizing_TO_RJA_Data_Return_From_AWS_S3"
          }
        ]
      }
    },
    "RJA_Simulate_AWS_Processing": {
      "Type": "Job:Command",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "Data Processing on AWS will now take place. We will simulate with this delay job. In practice we would trigger the Amazon AWS app to run via an API call and wait in turn to be called back when processing is complete.",
      "RunAs": "rjacobs@bmc.com",
      "Application": "RJA_MFT",
      "Command": "sleep 15",
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_ToS3_TO_RJA_Time_Delay"
          }
        ]
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_Simulate_AWS_Processing_TO_RJA_Finalizing"
          }
        ]
      }
    },
    "RJA_Begin_Data_Movement": {
      "Type": "Job:FileTransfer",
      "ConnectionProfileSrc": "RJA_B2B",
      "ConnectionProfileDest": "RJA_B2B",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "We are waiting for a file to be send by a customer so that we can process the Payroll Data. Once this file has been recieved, we will transfer it to an internal work location for further processing.",
      "RunAs": "RJA_B2B+RJA_B2B",
      "Application": "RJA_MFT",
      "Variables": [
        {
          "FTP-LOSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE1": "LOCAL"
        },
        {
          "FTP-LHOST": "Local"
        },
        {
          "FTP-LUSER": "ctmagent"
        },
        {
          "FTP-ROSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE2": "LOCAL"
        },
        {
          "FTP-RHOST": "Local"
        },
        {
          "FTP-RUSER": "ctmagent"
        },
        {
          "FTP-TIMELIMIT_UNIT1": "1"
        },
        {
          "FTP-OVERRIDE_WATCH_INTERVAL1": "0"
        },
        {
          "FTP-WATCH_INTERVAL1": "30"
        },
        {
          "FTP-CM_VER": "9.0.19"
        }
      ],
      "FileTransfers": [
        {
          "TransferType": "Binary",
          "TransferOption": "SrcToDestFileWatcher",
          "Src": "/opt/ctm/ctmagent/ctm/cm/AFT/ftshome/b2bhome/RJA_Elevate/incoming/RJA_upload_file.txt",
          "Dest": "/opt/ctm/training/data/RJA_upload_file.txt",
          "TIMELIMIT": "0",
          "ABSTIME": "0",
          "SRCOPT": "1",
          "IF_EXIST": "0",
          "DSTOPT": "0",
          "UNIQUE": "0",
          "RECURSIVE": "0",
          "TRIM": "1",
          "NULLFLDS": "0",
          "VERNUM": "0",
          "EXCLUDE_WILDCARD": "0",
          "CASEIFS": "0"
        }
      ],
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_Begin_Data_Movement_TO_RJA_To_AWS_S3"
          }
        ]
      }
    },
    "RJA_DATA_Back_to_Customer": {
      "Type": "Job:FileTransfer",
      "ConnectionProfileSrc": "RJA_B2B",
      "ConnectionProfileDest": "RJA_S3",
      "S3BucketName": "reggie-another-bucket",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "After the OPS Support team gave the go ahead, the file can be send back to the customer on the External work area.",
      "RunAs": "RJA_B2B+RJA_S3",
      "Application": "RJA_MFT",
      "Variables": [
        {
          "FTP-LOSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE1": "LOCAL"
        },
        {
          "FTP-LHOST": "Local"
        },
        {
          "FTP-LUSER": "ctmagent"
        },
        {
          "FTP-ROSTYPE": "Unix"
        },
        {
          "FTP-CONNTYPE2": "S3"
        },
        {
          "FTP-RHOST": "S3"
        },
        {
          "FTP-TIMELIMIT_UNIT1": "1"
        },
        {
          "FTP-OVERRIDE_WATCH_INTERVAL1": "0"
        },
        {
          "FTP-WATCH_INTERVAL1": "30"
        },
        {
          "FTP-CM_VER": "9.0.19"
        }
      ],
      "FileTransfers": [
        {
          "TransferType": "Binary",
          "TransferOption": "SrcToDest",
          "Src": "/opt/ctm/training/data/RJA_upload_file.txt",
          "Dest": "/Customer Processed/RJA_upload_file_Final_Processed.txt",
          "TIMELIMIT": "0",
          "ABSTIME": "0",
          "SRCOPT": "0",
          "IF_EXIST": "0",
          "DSTOPT": "0",
          "UNIQUE": "0",
          "RECURSIVE": "0",
          "TRIM": "1",
          "NULLFLDS": "0",
          "VERNUM": "0",
          "EXCLUDE_WILDCARD": "0",
          "CASEIFS": "0"
        }
      ],
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "IfBase:Folder:CompletionStatus_11": {
        "Type": "If:CompletionStatus",
        "CompletionStatus": "NOTOK",
        "Mail_0": {
          "Type": "Action:Mail",
          "Subject": "The processed payroll file has been send to the Customer AWS final destination successfully",
          "To": "rjacobs@bmc.com",
          "AttachOutput": true
        }
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_Data_Return_From_AWS_S3_TO_RJA_DATA_Back_to_Customer"
          }
        ]
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_DATA_Back_to_Customer_TO_RJA_Ready_For_Next_Day"
          }
        ]
      },
      "eventsToDelete": {
        "Type": "DeleteEvents",
        "Events": [
          {
            "Event": "RJA_Data_Return_From_AWS_S3_TO_RJA_DATA_Back_to_Customer"
          }
        ]
      }
    },
    "RJA_Ready_For_Next_Day": {
      "Type": "Job:Command",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "This will clean out all data to be ready for the next day's run.",
      "RunAs": "rjacobs@bmc.com",
      "Application": "RJA_MFT",
      "Command": "rm /opt/ctm/training/data/%%processedFilename",
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "IfBase:Folder:CompletionStatus_0": {
        "Type": "If:CompletionStatus",
        "CompletionStatus": "NOTOK",
        "Action:SetToOK_0": {
          "Type": "Action:SetToOK"
        }
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_DATA_Back_to_Customer_TO_RJA_Ready_For_Next_Day"
          }
        ]
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_Ready_For_Next_Day_TO_RJA_File_Service"
          }
        ]
      },
      "eventsToDelete": {
        "Type": "DeleteEvents",
        "Events": [
          {
            "Event": "RJA_DATA_Back_to_Customer_TO_RJA_Ready_For_Next_Day"
          }
        ]
      }
    },
    "RJA_Simulating_Processing": {
      "Type": "Job:Command",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "Data Processing on AWS will now take place. We will simulate with this delay job. In practice we would trigger the Amazon AWS app to run via an API call and wait in turn to be called back when processing is complete.",
      "RunAs": "rjacobs@bmc.com",
      "Application": "RJA_MFT",
      "Command": "sleep 25",
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "IfBase:Folder:CompletionStatus_0": {
        "Type": "If:CompletionStatus",
        "CompletionStatus": "OK",
        "Mail_0": {
          "Type": "Action:Mail",
          "Subject": "The processing on AWS has been completed succesfully",
          "To": "rjacobs@bmc.com",
          "AttachOutput": false
        }
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_To_AWS_S3_TO_RJA_Simulating_Processing"
          }
        ]
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_Simulating_Processing_TO_RJA_Finalizing"
          }
        ]
      },
      "eventsToDelete": {
        "Type": "DeleteEvents",
        "Events": [
          {
            "Event": "RJA_To_AWS_S3_TO_RJA_Simulating_Processing"
          }
        ]
      }
    },
    "RJA_Finalizing": {
      "Type": "Job:Command",
      "SubApplication": "RJA_FTP",
      "Confirm": true,
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "CreatedBy": "rjacobs",
      "Description": "Data Processing on AWS will now take place. We will simulate with this delay job. In practice we would trigger the Amazon AWS app to run via an API call and wait in turn to be called back when processing is complete.",
      "RunAs": "rjacobs@bmc.com",
      "Application": "RJA_MFT",
      "Command": "sleep 15",
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_Simulate_AWS_Processing_TO_RJA_Finalizing"
          },
          {
            "Event": "RJA_Simulating_Processing_TO_RJA_Finalizing"
          }
        ]
      },
      "eventsToAdd": {
        "Type": "AddEvents",
        "Events": [
          {
            "Event": "RJA_Finalizing_TO_RJA_Data_Return_From_AWS_S3"
          }
        ]
      },
      "eventsToDelete": {
        "Type": "DeleteEvents",
        "Events": [
          {
            "Event": "RJA_Simulate_AWS_Processing_TO_RJA_Finalizing"
          },
          {
            "Event": "RJA_Simulating_Processing_TO_RJA_Finalizing"
          }
        ]
      }
    },
    "RJA_File_Service": {
      "Type": "Job:SLAManagement",
      "ServiceName": "RJA_File_Service",
      "ServicePriority": "3",
      "SubApplication": "RJA_FTP",
      "Host": "vl-aus-ctm-mh01.ctm.bmc.com",
      "JobRunsDeviationsTolerance": "3",
      "CreatedBy": "rjacobs",
      "Description": "Job to monitor the transfer service",
      "RunAs": "DUMMYUSR",
      "Application": "RJA_MFT",
      "CompleteIn": {
        "Time": "0:20"
      },
      "When": {
        "WeekDays": [
          "NONE"
        ],
        "MonthDays": [
          "ALL"
        ],
        "DaysRelation": "OR"
      },
      "eventsToWaitFor": {
        "Type": "WaitForEvents",
        "Events": [
          {
            "Event": "RJA_Ready_For_Next_Day_TO_RJA_File_Service"
          }
        ]
      },
      "eventsToDelete": {
        "Type": "DeleteEvents",
        "Events": [
          {
            "Event": "RJA_Ready_For_Next_Day_TO_RJA_File_Service"
          }
        ]
      }
    }
  }
}
